
<style>
  thead {
    border: 2px solid #ccc;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin: 10px 0;
    border-radius: 1px ;
    color: black;
  }
 
  th,
  td {
    border: none;
    padding: 15px 0;
    text-align: center;
    font-weight: bold;
  }
  .heading div{
    font-size: 13px;
  } 
  th {
    background-color: #f2f2f2;
  }
 
   /* Custom border for a specific row */
  .row_custom_border {
    border: 2px solid #ccc; /* Adjust color and thickness as needed */
    border-radius: 10px; /* Adjust the border-radius value as needed */
  }

  .serial-no {
    width: 100px;
    height: 100px;
    background-color: #d9d9d9;
    border-radius: 50%;
    padding: 15px 20px;
  }
  .total-amt{
    color: #3E9C35;
    font-weight: bold;
  }
  .heading span{
    color: #746d6d;
    font-size: 11px;
  }
  /* .hide-data span{
    margin-bottom: 10px;
    visibility: hidden;
  } */
  
  .arrow-img{
    width: 25px;
    margin-top: 7px;
  }
  

  /******** table heading CSS start here **********/
  .pagination {
    display: inline-block;
  }
          
  .pagination a {
    color: black;
    float: left;
    padding: 5px 10px;
    text-decoration: none;
    transition: background-color 0.3s;
    border: 1px solid #ddd;
    border-radius: 50%;
    background-color: #d9d9d9;
    margin: 0 6px;
    font-weight: bold;
  }
          
  .pagination a.active {
    background-color: #4caf50;
    color: white;
    border: 1px solid #4caf50;
  }
             
  .pagination a:hover:not(.active) {                 
    background-color: #ddd;
  }
                
  .table-title {
    display: flex;
    align-items: center;
    margin-top: 18px;
    gap: 10px;
  }
          
  .tb-title h3 {
    display: inline-block;
    margin: 0; /* Remove default margin for inline elements */
    font-family: "Franklin Gothic Medium", "Arial Narrow", Arial, sans-serif;
  }
  /******** table heading CSS end here **********/

  .arrow {
    border: solid black;
    border-width: 0 3px 3px 0;
    display: inline-block;
    padding: 3px;
  }

  .right {
    transform: rotate(-45deg);
    -webkit-transform: rotate(-45deg);
  }

  span.hidden-arrow{
    visibility: hidden;
    background-color: #f2f2f2;
  }

  #load-more-btn {
    background-color: #5890FF;
    color: #f2f2f2;
    border: none;
    padding :8px 10px;
    cursor: pointer;
    border-radius: 2px;
    float: inline-end;
  }

  button#load-more-btn:focus{
   outline: none;
  }
  #show-less-btn{
    background-color: #5890FF;
    color: #f2f2f2;
    border: none;
    padding :8px 10px;
    cursor: pointer;
    border-radius: 2px;
  }
  button#show-less-btn:focus{
   outline: none;
  }

  .delete-icon {
    cursor: pointer;
    width: 28px;
    height: 28px;/* Adjust the height of the image */
}

.delete-icon:hover {
    cursor: pointer;
}

  /* Add responsive styles */
  @media only screen and (max-width: 600px) {
      .tb-title h3 {
        font-size: 14px;
      }
      td {
        font-weight: 600;
        font-size: 8px;
      }

      .heading span {
         font-size: 6px;
      }
      .serial-no {
        padding: 4px 8px;
      }
     .arrow {
        border-width: 0 1px 1px 0;
        padding: 2px;
      }
  }
</style>

<!-- Main Body start here -->
<div class="table-title">
  <div class="tb-title">
    <h3>Travel History</h3>
  </div>
  <!-- <div class="pagination">
    <a href="#"><</i></a>
    <a href="#">></i></a>
  </div> -->
</div>

<div style="overflow-x: auto;">
<table>
  <thead>
    <tr>
      <th>Sr. No.</th>
      <th>From </th>
      <th><span class="hidden-arrow">Hidden-arrow</span></th>
      <th>To </th>
      <th>Fare Amount</th>
      <th>Daily Allowance</th>
      <th>Halting</th>
      <th>Lodging</th>
      <th>Local Allowance</th>
      <th>Total</th>
      <!-- <th>Action</th> Added a new column for the delete button -->
    </tr>
  </thead>
  <tbody id="ta_chart_table_body">
    {% for index, row in enumerate(data) %}
    <!-- <tr class="row_custom_border "> -->
      <tr class="row_custom_border" {% if index >= 5 %}hidden{% endif %}>
     <td><span class="serial-no">{{ index + 1 }}</span></span></td>
      <!-- For date_and_time_start -->
 
<td>
  <div class="heading">
    <span>{{ row.formatted_date_start }}</span>
    <div>{{ row.from_location }}</div>
  </div>
</td>
<td>
  <div class="heading">
    <!-- <div class="hide-data">
      <span>hidden</span>
    </div> -->
    <!-- <div><p><i class="arrow right"></i></p></div> -->
    <div>
      <img class="arrow-img" src="/files/next.png"></img>
    </div>
  </div>
</td>

<!-- For date_and_time_end -->
<td>
  <div class="heading">
    <span>{{ row.formatted_date_end }}</span>
    <div>{{ row.to_location }}</div>
  </div>
</td>
<!-- <td>
  <div class="heading">
    <span>{{ row.da_claimed }}</span>
    <div>₹{{ row.daily_allowance }}</div>
  </div>
</td>
<td>
  <div class="heading">
    <span>{{ row.haltinglodging }}</span>
    <div>₹{{ row.haltinglodging_amount }}</div>
  </div>
</td> -->
<td>
  <div class="heading">
    <!-- <span>Fare Amount</span> -->
    <div>₹{{ row.fare_amount }}</div>
  </div>
</td>
<td>
  <div class="heading">
    {% if row.daily_allowance|default(0) | int > 0 %}
      <span>{{ row.da_claimed }}</span>
    {% endif %}
    <div>₹{{ row.daily_allowance }}</div>
  </div>
</td>
<td>
  <div class="heading">
    {% if row.halting_amount|default(0) | int > 0 %}
      <!-- <span>{{ row.halting }}</span> -->
    {% endif %}
    <div>₹{{ row.halting_amount }}</div>
  </div>
</td>

<td>
  <div class="heading">
    {% if row.lodging_amount|default(0) | int > 0 %}
      <!-- <span>{{ row.lodging }}</span> -->
    {% endif %}
    <div>₹{{ row.lodging_amount }}</div>
  </div>
</td>




<td>
  <div class="heading">
    <!-- <span>Local Allowance</span> -->
    <div>₹{{ row.local_conveyance_other_expenses_amount if row.local_conveyance_other_expenses_amount is not none else 0 }}</div>
  </div>
</td>

      <td >
        <div class="heading">
          <!-- <span>Total</span> -->
            <div class="total-amt">₹{{ row.total  }}</div>
        </div>
      </td>
      <!-- Add more columns as needed -->
      <!-- <td>
        <img class="delete-icon" src="/files/trash.png" alt="Delete" onclick="deleteRow(this)">
      </td> -->
    </tr>
    {% endfor %}
  </tbody>
</table>

<div>
  <button id="load-more-btn" onclick="loadMore()">Show More</button>
  <button id="show-less-btn" style="display:none;" onclick="showLess()">Show Less</button>
 </div>
</div>

 
 <script>
   let startIndex = 5; // Starting index for loading more rows
   let rowsPerPage = 5; // Number of rows to display per click
   let initialRowCount = 5; // Initial number of rows
 
   function loadMore() {
     let tableBody = document.getElementById('ta_chart_table_body');
     let rows = tableBody.getElementsByTagName('tr');
 
     for (let i = startIndex; i < startIndex + rowsPerPage && i < rows.length; i++) {
       rows[i].removeAttribute('hidden'); // Display the next set of rows
     }
 
     startIndex += rowsPerPage;
 
     // Show the "Show Less" button when additional rows are displayed
     if (startIndex < rows.length) {
       document.getElementById('show-less-btn').style.display = 'inline-block';
     }
 
     // Hide the "Load More" button if all rows are displayed
     if (startIndex >= rows.length) {
       document.getElementById('load-more-btn').style.display = 'none';
     }
 
     // Hide the "Show Less" button when only the initial set of rows is displayed
     if (startIndex <= initialRowCount) {
       document.getElementById('show-less-btn').style.display = 'none';
     }
   }
 
   function showLess() {
     // Update startIndex to point to the previous set of rows
     startIndex -= rowsPerPage;
 
     let tableBody = document.getElementById('ta_chart_table_body');
     let rows = tableBody.getElementsByTagName('tr');
 
     // Hide the last set of displayed rows
     for (let i = startIndex; i < startIndex + rowsPerPage && i < rows.length; i++) {
       rows[i].setAttribute('hidden', 'true');
     }
 
     // Show the "Load More" button
     document.getElementById('load-more-btn').style.display = 'inline-block';
 
     // Hide the "Show Less" button if we're back to the initial state
     if (startIndex <= initialRowCount) {
       document.getElementById('show-less-btn').style.display = 'none';
     }
   }


function deleteRow(element) {
  console.log("delete button");
  console.log("element:",element);

  // Get the row element
  var row = element.parentNode.parentNode;

  // Get the index of the row
  var rowIndex = Array.prototype.indexOf.call(row.parentNode.children, row);

  // Get the current form
  var frm = frappe.cur_frm;
  console.log(frm);

  // Confirm the deletion
  if (confirm("Are you sure you want to delete this row?")) {
    // Check if frm object and its properties are defined
    if (frm && frm.doctype && frm.docname) {
      // Remove the child row from the TA Chart table
      frappe.model.remove_from_locals(frm.doctype, frm.docname, "ta_chart", rowIndex);

      // Remove the row from the table in the UI
      row.remove();

      // Save the form
      frm.save();
    } else {
      console.error("Form object or its properties are undefined.");
    }
  }
}

 </script>
 